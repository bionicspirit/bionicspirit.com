<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width">

  <link rel="canonical" href="https://alexn.org/blog/2012/11/07/notes-javascript-development.html">
  <link rel="alternate" href="/atom.xml" title="Atom feed" type="application/atom+xml">

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@alexelcu" />

    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2012-11-07" />
    
    <meta property="article:tag" content="Javascript" />
    <meta property="article:tag" content="Functional" />
    <meta property="article:tag" content="Browser" />
    <meta property="article:tag" content="Web" />

    <title>Notes On Javascript Client-side Development</title>
    <meta name="og:title" content="Notes On Javascript Client-side Development" />
    <meta name="twitter:title" content="Notes On Javascript Client-side Development" />

      <meta name="og:image" content="https://alexn.org/assets/img/javascript_logo.jpg" />
      <meta name="og:image:secure_url" content="https://alexn.org/assets/img/javascript_logo.jpg" />
      <meta name="twitter:image" content="https://alexn.org/assets/img/javascript_logo.jpg" />

      <meta name="og:description" content="Javascript, Functional, Browser, Web" />
      <meta name="twitter:description" content="Javascript, Functional, Browser, Web" />
      <meta name="description" content="Javascript, Functional, Browser, Web" />

  <link href="/assets/css/fonts-8b37e535.css" rel="stylesheet" />
  <link href="/assets/css/all-b9d1ad87.css" rel="stylesheet" />
  <!--[if lt IE 9]>
  <link href="/assets/css/ie-hacks-0c76b2ed.css" rel="stylesheet" />
  <![endif]-->

   <script src="/assets/js/nocookies.js"></script>
</head>
<body>
  <div id="header-container">
    <header>
      <h1 id="title">alexn.org</h1>

      <meta itemprop="lastReviewed" content="2018-11-05"/>
      <div itemprop="reviewedBy" itemscope itemtype="https://schema.org/Person">
        <meta itemprop="name" content="Alexandru Nedelcu">
        <meta itemprop="url" content="https://alexn.org/about.html">
      </div>

      <div class="github-fork-ribbon-wrapper right">
        <div class="github-fork-ribbon">
          <a href="https://github.com/alexandru" itemprop="relatedLink">Fork me on GitHub</a>
        </div>
      </div>

      <nav>
    	  <a href="/">alexn.org</a>
    	  <a class="extra" href="/about.html" itemprop="significantLink">About</a>
      </nav>
    </header>
  </div>

  <div id="main-container">
    <div id="main">
      <article id="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <h1 itemprop="headline">Notes On Javascript Client-side Development</h1>

    <div id="meta">
      <meta itemscope itemprop="mainEntityOfPage"  itemType="https://schema.org/WebPage" itemid="https://alexn.org/blog/2012/11/07/notes-javascript-development.html"/>
      <meta itemprop="datePublished" content="2012-11-07"/>
      <meta itemprop="dateModified" content="2012-11-07"/>

      <time class="post-date" itemprop="dateCreated" datetime="2012-11-07">
        Nov 07, 2012
      </time>

      <span class="twitter-link">
        â€¢ <a href="https://twitter.com/alexelcu">@alexelcu</a>
      </span>

        <div itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
          <meta itemprop="url" content="https://alexn.org/assets/img/javascript_logo.jpg">
          <meta itemprop="width" content="230">
          <meta itemprop="height" content="194">
        </div>

      <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <meta itemprop="name" content="Alexandru Nedelcu">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
          <meta itemprop="url" content="https://alexn.org/assets/img/alex-big-version-72ppi.jpg">
          <meta itemprop="width" content="585">
          <meta itemprop="height" content="585">
        </div>
      </div>
    </div>
  </header>

  <div id="content" itemprop="articleBody">
    <p><img src="/assets/img/javascript_logo.jpg" class="right" width="230" height="194" alt="Javascript logo" /></p>

<p>Client-side Javascript development can be quite overwhelming, even for
senior developers. I'm describing here what I did in a recent piece of
client-side functionality to keep my sanity. This interface I'm
talking about is served on mobile-phones, so it must be pretty
bloat-free, adding salt over injury.</p>

<h2 id="dealing-with-modules-packaging-and-minifying">Dealing with modules, packaging and minifying</h2>

<p>This is probably my biggest gripe with Javascript, that you can't
simply <code class="highlighter-rouge">require("some.namespace")</code> without extra glue and tricks. This
is a limitation of the browser, as such operations would have to be
executed asynchronously, requiring tedious callbacks and because of
bandwidth constraints you may want to serve everything in a single
optimized and gzipped JS.</p>

<!-- read more -->

<p><strong><a href="http://brunch.io/">Brunch.io</a></strong> is an awesome tool that helps you
do that. You split your project in multiple files, then Brunch can do
the assembling for you. To have modules in your project (splitting it
in several files), Brunch works with the
<a href="http://wiki.commonjs.org/wiki/Modules/1.1">CommonJS modules</a>
interface. All that means is that your Javascript files will end-up
looking like this:</p>

<div class="highlight"><pre class="highlight javascript"><code><span class="c1">// for importing another module</span>
<span class="nx">utils</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"path/to/utils"</span><span class="p">)</span>

<span class="kd">function</span> <span class="nx">generateRandomString</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">userAgent</span> <span class="o">=</span> <span class="nb">navigator</span><span class="p">.</span><span class="nx">userAgent</span>	
	<span class="kd">var</span> <span class="nx">rnd</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100000000</span>
    <span class="k">return</span> <span class="nx">utils</span><span class="p">.</span><span class="nx">md5</span><span class="p">(</span><span class="nx">userAgent</span> <span class="o">+</span> <span class="nx">rnd</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// exporting function for consumption from other modules</span>
<span class="nx">modules</span><span class="p">.</span><span class="k">export</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">generateRandomString</span><span class="p">:</span> <span class="nx">generateRandomString</span>
<span class="p">}</span>
</code></pre></div>
<p>Building changes and seeing them in your browser works really fast, as
Brunch can watch for changes in real-time and also exposes a built-in
server. So Brunch can take care of packaging for all your modules in a
single JS file, also minimizing for production if you want. The
workflow is pretty sweat, the configuration simple.</p>

<h2 id="dealing-with-javascripts-syntax-quirks">Dealing with Javascript's Syntax Quirks</h2>

<p>Javascript is a capable language exposed by an awful syntax and
plagued by incompatibilities - did you know that placing extra commas
or other punctuation will cause syntax errors in older browsers? So
it's not just about API incompatibilities, the syntax itself can lead
to surprises.</p>

<p>Brunch can be configured to check your code with
<a href="http://www.jshint.com/">JSHint</a>, which is a Linter that can check for
syntax errors and you can use it to force upon yourself and your team
certain best practices. It has a lot of
<a href="http://www.jshint.com/docs/">configuration options</a> and for instance
it can trigger errors on uninitialized variables and other
tremendously useful stuff.</p>

<p>I've used <a href="http://coffeescript.org/">CoffeeScript</a> as Brunch can work
with any language, with the proper plugin. I preferred CoffeeScript
because I develop in a more functional style and CoffeeScript has a
lighter syntax for anonymous functions, plus some other fixes to
Javascript, like "class" or the fat-arrow that binds the defined
function to the current <code class="highlighter-rouge">this</code> (tremendously useful). I coupled
CoffeeScript with <a href="http://www.coffeelint.org/">CoffeeLint</a> and for
instance I disabled the implicit braces when declaring object
literals, as I hate that syntax and don't want to get sucked into
it. What I really wanted however was
<a href="http://www.typescriptlang.org/">TypeScript</a>, which is like
Javascript, but with nice add-ons. Unfortunately it's too immature and
so
<a href="https://twitter.com/brunch/status/253571565923467264">it isn't included by Brunch's authors yet</a>,
but it probably will be at some point.</p>

<h2 id="dealing-with-async-events">Dealing with Async Events</h2>

<p>Many people use <a href="http://backbonejs.org/">Backbone.js</a> or things based
on it. What Backbone gives you, besides a structure for your app with
controllers and models, it also gives you a foundation for using the
<a href="http://en.wikipedia.org/wiki/Observer_pattern">Observer pattern</a>. So
your app initiates events that produce data and in response to user
actions or new data, you have to update stuff.</p>

<p>However my use-case was simple (the interface can be described by a
state-machine, without many things going on as far as the UI is
concerned). And <em>I absolutely hate</em> this consumer/producer model with
listeners, because I can't really wrap my head around it even for the
simplest of examples, as this model was really designed for usage
inside an IDE, where you can right-click on components and see all the
registered listeners for certain events.</p>

<p><strong><a href="https://github.com/kriskowal/q">The Q library</a></strong> - is one library
I'm using for dealing with <em>future</em> responses (a promise for a
response that may be available at a later time) and for avoiding the
<a href="http://calculist.org/blog/2011/12/14/why-coroutines-wont-work-on-the-web/">Pyramid of Doom</a>.</p>

<p>You see, many people choose something like Backbone because it makes
asynchronicity easier to deal with. I chose against it by building
small functions that compose, binding them together with Q. Works
great for small projects, even if the asynchronous calls are difficult
to compose, because working with promises makes that easy - note that
<a href="https://gist.github.com/3889970">jQuery's implementation is broken</a>,
so don't use it, just wrap jQuery's ajax calls in a Q promise.</p>

<p>Also, the great thing about preferring small functions with
referential transparency that compose is that testing becomes so much
easier. Brunch can also run your tests and you can use something like
<a href="http://chaijs.com/">Chai</a> or other helpers for testing nirvana.</p>

<p>This doesn't mean that Backbone and data flows with something like Q
can't be used together. I can certainly see myself working with
Backbone for larger projects.</p>

<h2 id="going-mobile">Going Mobile</h2>

<p>Other libraries I'm using are:</p>

<ul>
  <li><a href="http://underscorejs.org/">Underscore.js</a>, which provides much
needed API additions, some of which are available in latest versions
of JS, but not on older browsers. You definitely need this if you
like to program in a more functional style</li>
  <li><a href="http://zeptojs.com/">Zepto</a> instead of jQuery, because this
interface is served on mobile phones and jQuery is pretty
bloated. I'll also probably switch to
<a href="http://www.jqmobi.com/">jqMobi</a> because it's even lighter.</li>
</ul>

<p>In regards to jQuery alternatives, well jQuery adds like 33KB of
gzipped Javascript to my download. This may not be an issue in a
browser that has jQuery already cached, but in a fresh
<a href="http://developer.android.com/reference/android/webkit/WebView.html">WebView</a>
it's really big for normal 3G connections. My final JS file that gets
downloaded only has 20KB of gzipped JS, in total, including the
libraries I mentioned and it won't grow over 30KB. In combination with
a CDN like <a href="http://aws.amazon.com/cloudfront/">CloudFront</a> that's
still reasonable.</p>

<p>The ideal would be to use something like the
<a href="https://developers.google.com/closure/">Google Closure</a> compiler,
which can do tree-shaking, getting rid of pieces of code you don't
need. However, the code has to follow the Closure conventions,
otherwise it will behave no better than a normal minifier and
libraries like jQuery don't follow them. That's why I have high hopes
for <a href="http://www.typescriptlang.org/">TypeScript</a>, because it has a
built-in dependency system and you can annotate with types even
outside libraries, so a tree-shaker could work for popular libraries
if there's enough interest, even if the library in question does not
follow any conventions. I also thought about using
<a href="https://github.com/clojure/clojurescript">ClojureScript</a>, which emits
Closure-compatible Javascript, but I'm not familiar enough with the
language, so maybe some other day :-)</p>

<h2 id="as-a-conclusion">As a conclusion</h2>

<p>Keep things simple and work with tools provided by the Node.js
community, because that's where the real action is.</p>


    <div class="authorship" itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alexandru Nedelcu">
      Written by <a href="https://alexn.org/about.html" itemprop="url" rel="author">
        Alexandru Nedelcu</a> |
      <a href="https://twitter.com/alexelcu" itemprop="url" rel="author">
        Twitter</a> |
      <a href="https://github.com/alexandru" itemprop="url" rel="author">
        GitHub</a>
    </div>
  </div>

  <footer>
    <div id="other-articles">
      <h2>Recent Articles</h2>

      <ul class="posts">
      	<li>
      	  <time datetime="2018-05-06">
      	    2018-05-06 &raquo;
      	  </time>
      	  <a href="/blog/2018/05/06/bifunctor-io.html" rel="prefetch related">On Bifunctor IO and Java's Checked Exceptions</a>
      	</li>
      	<li>
      	  <time datetime="2018-02-12">
      	    2018-02-12 &raquo;
      	  </time>
      	  <a href="/blog/2018/02/12/in-defense-oofp.html" rel="prefetch related">In Defense of OOFP</a>
      	</li>
      	<li>
      	  <time datetime="2017-11-10">
      	    2017-11-10 &raquo;
      	  </time>
      	  <a href="/blog/2017/11/10/minitest-no-crap-scala-library.html" rel="prefetch related">Minitest: Zero Crap Scala Testing Library</a>
      	</li>
      	<li>
      	  <time datetime="2017-10-15">
      	    2017-10-15 &raquo;
      	  </time>
      	  <a href="/blog/2017/10/15/functional-programming.html" rel="prefetch related">What is Functional Programming?</a>
      	</li>
      	<li>
      	  <time datetime="2017-10-13">
      	    2017-10-13 &raquo;
      	  </time>
      	  <a href="/blog/2017/10/13/scaladays-copenhagen.html" rel="prefetch related">Scala Days 2017 â€” Monix Task</a>
      	</li>
      	<li>
      	  <time datetime="2017-10-11">
      	    2017-10-11 &raquo;
      	  </time>
      	  <a href="/blog/2017/10/11/javascript-promise-leaks-memory.html" rel="prefetch related">JavaScript's Promise Leaks Memory</a>
      	</li>
      	<li>
      	  <time datetime="2017-08-16">
      	    2017-08-16 &raquo;
      	  </time>
      	  <a href="/blog/2017/08/16/automatic-releases-sbt-travis.html" rel="prefetch related">Automatic Releases to Maven Central with Travis and SBT</a>
      	</li>
      </ul>
    </div>

    <div id="contributions">
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_shortname = 'alexnorg';
        var disqus_url = 'http://alexn.org/blog/2012/11/07/notes-javascript-development.html';

        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </footer>
</article>

    </div>
  </div>

  <div id="footer-container">
    <footer>
      <div class="contact">
      	&copy; 2018 Alexandru Nedelcu
      	<br>
      	Some rights reserved (<a href="http://creativecommons.org/licenses/by-nc/3.0/" rel="license">CC BY-NC 3.0</a>)
      </div>

      <div class="rss">
      	<a href="https://twitter.com/alexelcu" target="_blank" title="Follow me on Twitter (@alexelcu)">
      	  <img src="/assets/img/twitter-logo.png" width="60" height="60" alt="Follow me on Twitter (@alexelcu)" />
      	</a>
      </div>
    </footer>
  </div>
</body>
</html>
